!function(t){var e={};function i(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(o,s,function(e){return t[e]}.bind(null,s));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const o={};function s(t,e){return(e||document).querySelector(t)}function l(t,e,i,o){t.addEventListener(e,i,!!o)}function n(t,e,i,o,s){l(t,i,i=>{const s=i.target,l=t.querySelectorAll(e);let n=l.length;for(;n--;)if(l[n]===s){o.call(s,i);break}},!!s)}const d=t=>t.replace(/[&<]/g,t=>"&"===t?"&amp;":"&lt;");const r=t=>parseInt(t.parentNode.dataset.id||t.parentNode.parentNode.dataset.id,10),a=13,c=27;const m=new class{constructor(t,e){this.store=t,this.view=e,e.bindAddItem(this.addItem.bind(this)),e.bindEditItemSave(this.editItemSave.bind(this)),e.bindEditItemCancel(this.editItemCancel.bind(this)),e.bindRemoveItem(this.removeItem.bind(this)),e.bindToggleItem((t,e)=>{this.toggleCompleted(t,e),this._filter()}),e.bindRemoveCompleted(this.removeCompletedItems.bind(this)),e.bindToggleAll(this.toggleAll.bind(this)),this._activeRoute="",this._lastActiveRoute=null}setView(t){const e=t.replace(/^#\//,"");this._activeRoute=e,this._filter(),this.view.updateFilterButtons(e)}addItem(t){this.store.insert({id:Date.now(),title:t,completed:!1},()=>{this.view.clearNewTodo(),this._filter(!0)})}editItemSave(t,e){e.length?this.store.update({id:t,title:e},()=>{this.view.editItemDone(t,e)}):this.removeItem(t)}editItemCancel(t){this.store.find({id:t},e=>{const i=e[0].title;this.view.editItemDone(t,i)})}removeItem(t){this.store.remove({id:t},()=>{this._filter(),this.view.removeItem(t)})}removeCompletedItems(){this.store.remove({completed:!0},this._filter.bind(this))}toggleCompleted(t,e){this.store.update({id:t,completed:e},()=>{this.view.setItemComplete(t,e)})}toggleAll(t){this.store.find({completed:!t},e=>{for(let{id:i}of e)this.toggleCompleted(i,t)}),this._filter()}_filter(t){const e=this._activeRoute;(t||""!==this._lastActiveRoute||this._lastActiveRoute!==e)&&this.store.find({"":o,active:{completed:!1},completed:{completed:!0}}[e],this.view.showItems.bind(this.view)),this.store.count((t,e,i)=>{this.view.setItemsLeft(e),this.view.setClearCompletedButtonVisibility(i),this.view.setCompleteAllCheckbox(i===t),this.view.setMainVisibility(t)}),this._lastActiveRoute=e}}(new class{constructor(t,e){const i=window.localStorage;let o;this.getLocalStorage=(()=>o||JSON.parse(i.getItem(t)||"[]")),this.setLocalStorage=(e=>{i.setItem(t,JSON.stringify(o=e))}),e&&e()}find(t,e){let i;e(this.getLocalStorage().filter(e=>{for(i in t)if(t[i]!==e[i])return!1;return!0}))}update(t,e){const i=t.id,o=this.getLocalStorage();let s,l=o.length;for(;l--;)if(o[l].id===i){for(s in t)o[l][s]=t[s];break}this.setLocalStorage(o),e&&e()}insert(t,e){const i=this.getLocalStorage();i.push(t),this.setLocalStorage(i),e&&e()}remove(t,e){let i;const o=this.getLocalStorage().filter(e=>{for(i in t)if(t[i]!==e[i])return!0;return!1});this.setLocalStorage(o),e&&e(o)}count(t){this.find(o,e=>{const i=e.length;let o=i,s=0;for(;o--;)s+=e[o].completed;t(i,i-s,s)})}}("myDatabaseName"),new class{constructor(t){this.template=t,this.$todoList=s(".todo-list"),this.$todoItemCounter=s(".todo-count"),this.$clearCompleted=s(".clear-completed"),this.$main=s(".main"),this.$toggleAll=s(".toggle-all"),this.$newTodo=s(".new-todo"),n(this.$todoList,"li label","dblclick",({target:t})=>{this.editItem(t)})}editItem(t){const e=t.parentElement.parentElement;e.classList.add("editing");const i=document.createElement("input");i.className="edit",i.value=t.innerText,e.appendChild(i),i.focus()}showItems(t){this.$todoList.innerHTML=this.template.itemList(t)}removeItem(t){const e=s(`[data-id="${t}"]`);e&&this.$todoList.removeChild(e)}setItemsLeft(t){this.$todoItemCounter.innerHTML=this.template.itemCounter(t)}setClearCompletedButtonVisibility(t){this.$clearCompleted.style.display=t?"block":"none"}setMainVisibility(t){this.$main.style.display=t?"block":"none"}setCompleteAllCheckbox(t){this.$toggleAll.checked=!!t}updateFilterButtons(t){s(".filters .selected").className="",s(`.filters [href="#/${t}"]`).className="selected"}clearNewTodo(){this.$newTodo.value=""}setItemComplete(t,e){const i=s(`[data-id="${t}"]`);i&&(i.className=e?"completed":"",s("input",i).checked=e)}editItemDone(t,e){const i=s(`[data-id="${t}"]`),o=s("input.edit",i);i.removeChild(o),i.classList.remove("editing"),s("label",i).textContent=e}bindAddItem(t){l(this.$newTodo,"change",({target:e})=>{const i=e.value.trim();i&&t(i)})}bindRemoveCompleted(t){l(this.$clearCompleted,"click",t)}bindToggleAll(t){l(this.$toggleAll,"click",({target:e})=>{t(e.checked)})}bindRemoveItem(t){n(this.$todoList,".destroy","click",({target:e})=>{t(r(e))})}bindToggleItem(t){n(this.$todoList,".toggle","click",({target:e})=>{t(r(e),e.checked)})}bindEditItemSave(t){n(this.$todoList,"li .edit","blur",({target:e})=>{e.dataset.iscanceled||t(r(e),e.value.trim())},!0),n(this.$todoList,"li .edit","keypress",({target:t,keyCode:e})=>{e===a&&t.blur()})}bindEditItemCancel(t){n(this.$todoList,"li .edit","keyup",({target:e,keyCode:i})=>{i===c&&(e.dataset.iscanceled=!0,e.blur(),t(r(e)))})}}(new class{itemList(t){return t.reduce((t,e)=>t+`\n<li data-id="${e.id}" ${e.completed?' class="completed"':""} >\n\t<div class="view">\n\t\t<input class="toggle" type="checkbox" ${e.completed?"checked":""}>\n\t\t<label>${d(e.title)}</label>\n\t\t<button class="destroy"></button>\n\t</div>\n</li>`,"")}itemCounter(t){return`${t} item${1!==t?"s":""} left`}})),h=()=>m.setView(document.location.hash);l(window,"load",h),l(window,"hashchange",h)}]);